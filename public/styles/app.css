/* v-sep: wrapper(id=vsep) → inner(.v-sep). Use descendant selector */
#vsep .v-sep{width:1px;height:calc(100vh - 180px);background:#9ca3af;margin:6px 8px;}
#threads_list .ctx-dots,
#threads_list_tab .ctx-dots{position:absolute; right:8px; top:8px; display:none; background:#111827; border:1px solid #374151; color:#e5e7eb; padding:2px 6px; border-radius:6px; font-size:12px; line-height:1}
#threads_list .thread-link.selected .ctx-dots{display:inline-flex}
/* スレッドタブではインライン操作ボタンがあるため「…」は非表示 */
#threads_list_tab .ctx-dots{display:none !important}
#threads_list .thread-link[data-empty='1'] .ctx-dots,
#threads_list_tab .thread-link[data-empty='1'] .ctx-dots{display:none}
#threads_list .mark-pill,
#threads_list_tab .mark-pill{display:inline-block; padding:1px 6px; margin-right:6px; border:1px solid #374151; border-radius:9999px; font-size:10px; color:#9ca3af; background:#111827}
/* ctx-menu is appended to document.body → needs global rules */
.ctx-menu{position:fixed; z-index:9999; background:#111827; border:1px solid #374151; border-radius:8px; box-shadow:0 8px 16px rgba(0,0,0,.35);}
.ctx-item{padding:8px 12px; color:#e5e7eb; cursor:pointer;}
.ctx-item:hover{background:#374151}
/* hidden trigger components should be hidden globally (not only in lists) */
.hidden-trigger{display:none !important; visibility:hidden !important; width:0 !important; height:0 !important;}
/* improve dots click affordance */
#threads_list .ctx-dots, #threads_list_tab .ctx-dots{ cursor:pointer; }
/* threads list (scoped by ids where applicable) */
#sidebar-toggle-row button{min-width:36px;}
#sidebar_toggle_btn{margin-left:auto;}
.threads-list{display:block}
#sidebar_col{overflow:hidden;}
#threads_list{overflow-y:auto; max-height:calc(100vh - 220px);}
#threads_list .thread-link:hover,
#threads_list_tab .thread-link:hover{background:#f3f4f6}
#threads_list .thread-link.selected,
#threads_list_tab .thread-link.selected{background:#e5e7eb; outline:1px solid #9ca3af}
#threads_list .thread-title,
#threads_list_tab .thread-title{display:block; text-align:left; color:#111827; font-weight:600; font-size:14px}
#threads_list .thread-row,
#threads_list_tab .thread-row{display:flex; align-items:flex-start; gap:8px}
#threads_list .thread-main,
#threads_list_tab .thread-main{flex:1; min-width:0}
#threads_list .thread-summary,
#threads_list_tab .thread-summary{display:block; color:#4b5563; font-size:11px; margin-top:2px; text-align:left; word-break:break-word}
#threads_list .thread-actions,
#threads_list_tab .thread-actions{display:flex; gap:6px; align-items:center}
#threads_list .thread-btn,
#threads_list_tab .thread-btn{background:#111827; border:1px solid #374151; color:#e5e7eb; padding:4px 6px; border-radius:6px; font-size:12px}
#threads_list .thread-btn:hover,
#threads_list_tab .thread-btn:hover{background:#1f2937}
/* thread-link base (migrated from inline in app_factory.py) */
#threads_list .thread-link,
#threads_list_tab .thread-link{padding:8px 10px; cursor:pointer; border-radius:6px; position:relative;}
/* =================== Tokens =================== */
:root{
  --avatar-base: 32px;
  --avatar-zoom: 1.1;
  --avatar-gap: .3rem;
  --avatar-shift-y: -2px;
  --avatar-ring: 0px;

  --text:#111827; --card:#fff; --card-border:#e5e7eb; --code-bg:#f8fafc;
  --chat-btn-gap:10px; --stop-nudge:12px; --stop-diameter:36px;
  --stop-bg:#6b7280; --send-bg:#60A5FA; --stop-total-w:var(--stop-diameter);
  --chip-bg:#e5e7eb; --search-band-bg:#F1F5F9; --search-band-radius:10px; --search-band-pad:12px;
  --search-bg:#EEF2FF; --search-text:#111827; --search-border:#BFDBFE; --search-ph:#6B7280;
  --search-bg-focus:#fff; --search-outline:rgba(37,99,235,.25);
}
/* ===== Theme bridge enforced styles (ui-light/ui-dark set by theme_bridge.js) ===== */
html.ui-light #threads_list, html.ui-light #threads_list_tab{ color:#111827 !important; }
html.ui-light #threads_list .thread-link, html.ui-light #threads_list_tab .thread-link{ opacity:1 !important; filter:none !important; }
html.ui-light #threads_list .thread-link *, html.ui-light #threads_list_tab .thread-link *{ opacity:1 !important; }
html.ui-light #threads_list .thread-link:hover, html.ui-light #threads_list_tab .thread-link:hover{ background:#f3f4f6 !important; }
html.ui-light #threads_list .thread-link.selected, html.ui-light #threads_list_tab .thread-link.selected{ background:#e5e7eb !important; outline:1px solid #9ca3af !important; }
html.ui-light #threads_list .thread-title, html.ui-light #threads_list_tab .thread-title{ color:#111827 !important; }
html.ui-light #threads_list .thread-link.selected .thread-title, html.ui-light #threads_list_tab .thread-link.selected .thread-title{ color:#111827 !important; }
html.ui-light #threads_list .thread-link:not(.selected) .thread-title, html.ui-light #threads_list_tab .thread-link:not(.selected) .thread-title{ color:#1f2937 !important; font-weight:700 !important; }
html.ui-light #threads_list .thread-summary, html.ui-light #threads_list_tab .thread-summary{ color:#4b5563 !important; }

html.ui-dark #threads_list, html.ui-dark #threads_list_tab{ color:#e5e7eb !important; }
html.ui-dark #threads_list .thread-link, html.ui-dark #threads_list_tab .thread-link{ opacity:1 !important; filter:none !important; }
html.ui-dark #threads_list .thread-link *, html.ui-dark #threads_list_tab .thread-link *{ opacity:1 !important; }
html.ui-dark #threads_list .thread-link:hover, html.ui-dark #threads_list_tab .thread-link:hover{ background:#374151 !important; }
html.ui-dark #threads_list .thread-link.selected, html.ui-dark #threads_list_tab .thread-link.selected{ background:#1f2937 !important; outline:1px solid #6b7280 !important; }
html.ui-dark #threads_list .thread-title, html.ui-dark #threads_list_tab .thread-title{ color:#e5e7eb !important; }
html.ui-dark #threads_list .thread-link.selected .thread-title, html.ui-dark #threads_list_tab .thread-link.selected .thread-title{ color:#e5e7eb !important; }
html.ui-dark #threads_list .thread-link:not(.selected) .thread-title, html.ui-dark #threads_list_tab .thread-link:not(.selected) .thread-title{ color:#e5e7eb !important; font-weight:700 !important; }
html.ui-dark #threads_list .thread-summary, html.ui-dark #threads_list_tab .thread-summary{ color:#9ca3af !important; }


/* ===== Chat bubbles ===== */
.gr-chatbot .message{
  background:var(--card) !important; color:var(--text) !important;
  border:1px solid var(--card-border) !important; border-radius:14px !important; box-shadow:none !important;
}
.gr-chatbot .message-row{ box-shadow:none !important; background:transparent !important; }

/* ===== アバター列：列幅は拡大後寸法に合わせる ===== */
.gr-chatbot .message-row{
  display:grid !important;
  grid-template-columns: calc(var(--avatar-base) * var(--avatar-zoom)) 1fr !important;
  align-items:center !important;
  column-gap: var(--avatar-gap) !important;
  min-height: calc(var(--avatar-base) * var(--avatar-zoom)) !important;
  overflow:visible !important;
}

/* GradioのDOMで用いられる avatar-container を直接拡大 */
.avatar-container{
  width: calc(var(--avatar-base) * var(--avatar-zoom)) !important;
  height: calc(var(--avatar-base) * var(--avatar-zoom)) !important;
  min-width: calc(var(--avatar-base) * var(--avatar-zoom)) !important;
  min-height: calc(var(--avatar-base) * var(--avatar-zoom)) !important;
  display:grid !important; place-items:center !important;
  border-radius:9999px !important; overflow:visible !important;
  background:#fff !important;
  box-shadow: 0 0 0 var(--avatar-ring) #fff !important;
}
.avatar-container > :is(img,svg){
  width:100% !important; height:100% !important; display:block !important;
  object-fit:contain !important;
  object-position: center calc(50% + var(--avatar-shift-y)) !important;
  border-radius:9999px !important;
}

/* ===== 入力行 ===== */
#msgrow{ position:relative; width:100%; }
#msgrow .gr-button > button{ min-width:0 !important; }
#stopbtn,#sendbtn{
  position:absolute; top:50%; transform:translateY(-50%);
  right:calc(var(--chat-btn-gap) + var(--stop-nudge));
  width:var(--stop-diameter) !important; height:var(--stop-diameter) !important;
  border-radius:9999px !important; display:flex; align-items:center; justify-content:center;
  padding:0 !important; margin:0 !important; z-index:5;
}
#stopbtn{ background:var(--stop-bg) !important; } #sendbtn{ background:var(--send-bg) !important; }
#stopbtn > button,#sendbtn > button{
  width:100% !important; height:100% !important; background:transparent !important; color:#fff !important;
  border:none !important; box-shadow:none !important; font-size:14px; line-height:1;
  display:inline-flex; align-items:center; justify-content:center;
}
#msgrow input,#msgrow textarea{
  padding-right:calc(var(--stop-total-w) + var(--chat-btn-gap) + var(--stop-nudge)) !important;
}
#msgrow .gr-textbox{ margin-bottom:0 !important; }

/* ===== ステータス / 検索UI ===== */
#status{ min-height:1.6em; line-height:1.6em; overflow:hidden !important; }
#status *{ overflow:hidden !important; margin:0 !important; }
#status .prose,#status .markdown,#status .gr-prose{ white-space:nowrap; text-overflow:ellipsis; }
.combo-field .wrap, .combo-field .wrap.svelte-1ipelgc{ gap:.5rem; }
.combo-field .gr-textbox input{ border-top-right-radius:0; border-bottom-right-radius:0; }
.combo-field .gr-button{ border-top-left-radius:0; border-bottom-left-radius:0; }
.combo-field .chips{ display:flex; flex-wrap:wrap; gap:.4rem; margin-top:.25rem; }
.combo-field .chip{ background:var(--chip-bg); border-radius:9999px; padding:.2rem .6rem; font-size:.9rem; }
.combo-hint{ opacity:.8; margin-top:.25rem; }
#search_band{ background:var(--search-band-bg) !important; border-radius:var(--search-band-radius); padding:var(--search-band-pad); }
#search_band .gr-textbox,#search_band .gr-button{ margin-top:0 !important; margin-bottom:0 !important; }
#searchbox input,#searchbox textarea{ background:var(--search-bg) !important; color:var(--search-text) !important; border-color:var(--search-border) !important; }
#searchbox input::placeholder,#searchbox textarea::placeholder{ color:var(--search-ph) !important; opacity:1; }
#searchbox input:focus,#searchbox textarea:focus{
  background:var(--search-bg-focus) !important; border-color:#2563EB !important;
  box-shadow:0 0 0 3px var(--search-outline) !important; outline:none !important;
}


/* ===== Light mode: reinforce readable text for labels/sliders (Gradio controls) ===== */
html.ui-light .gradio-container label,
html.ui-light .gradio-container [data-testid="block-label"],
html.ui-light .gradio-container .label{
  color:#111827 !important;
}
html.ui-light .gradio-container [role="slider"],
html.ui-light .gradio-container [role="slider"] ~ *,
html.ui-light .gradio-container input[type="range"] ~ *{
  color:#111827 !important;
}
